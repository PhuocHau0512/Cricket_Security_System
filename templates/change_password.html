{% extends "base.html" %}

{% block title %}Đổi Mật Khẩu - Cricket Security{% endblock %}

{% block content %}
<div class="row justify-content-center mt-5">
    <div class="col-md-6">
        <div class="card shadow">
            <div class="card-header py-3 bg-primary text-white">
                <h5 class="m-0"><i class="fas fa-key"></i> Đổi Mật Khẩu</h5>
            </div>
            <div class="card-body">
                <form method="POST" id="passwordForm">
                    <div class="mb-3">
                        <label class="form-label">Mật khẩu hiện tại</label>
                        <input type="password" class="form-control" name="current_password" required>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Mật khẩu mới</label>
                        <input type="password" class="form-control" name="new_password" id="newPassword" required>
                        <div class="progress mt-2" style="height: 5px;">
                            <div class="progress-bar" id="strengthBar" role="progressbar" style="width: 0%"></div>
                        </div>
                        <small class="text-muted" id="passwordHint">
                            Yêu cầu: 8+ ký tự, chữ hoa, chữ thường, số, ký tự đặc biệt.
                        </small>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Xác nhận mật khẩu mới</label>
                        <input type="password" class="form-control" name="confirm_password" required>
                    </div>

                    <div class="d-grid gap-2">
                        <button type="submit" class="btn btn-primary">Lưu thay đổi</button>
                        <a href="{{ url_for('dashboard') }}" class="btn btn-light">Hủy bỏ</a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('newPassword').addEventListener('input', function() {
    const password = this.value;
    let strength = 0;
    
    // Logic kiểm tra độ mạnh
    if (password.length >= 8) strength += 25;
    if (password.match(/[a-z]/)) strength += 25;
    if (password.match(/[A-Z]/)) strength += 25;
    if (password.match(/[0-9]/) || password.match(/[^a-zA-Z0-9]/)) strength += 25;
    
    const bar = document.getElementById('strengthBar');
    bar.style.width = strength + '%';
    
    if (strength < 50) {
        bar.className = 'progress-bar bg-danger';
    } else if (strength < 100) {
        bar.className = 'progress-bar bg-warning';
    } else {
        bar.className = 'progress-bar bg-success';
    }
});
</script>
{% endblock %}